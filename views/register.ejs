<%-include ("./partials/header")  -%>
<!-- updated syntax in ejs v3.0.1 -->
<div class="row">
    <div style="width: 35%; margin: 25px auto;">
        <h1 style="text-align: center">Sign Up</h1>
        <form id="form" class="mt-4" action="/register" method="post">
            <div class="form-group">
                <input class="form-control" id="username" type="text" name="username" placeholder="username" required>
            </div>
            <div class="form-group">
                <input class="form-control" id="password1" type="password" name="password1" placeholder="password" required>
            </div>
            <div class="form-group">
                <input class="form-control" id="password2" type="password" name="password2" placeholder="comfirm password" required>
            </div>
            <p class="worning-flash" id="passwordFlash1"></p>
            <p class="worning-flash" id="passwordFlash2"></p>
            <div class="form-group">
                <button id="submitBtn" disabled="disabled" class="btn btn-lg btn-primary btn-block">Sign Up!</button>
            </div>
        </form>
        <a href="/campgrounds">Go Back</a>
    </div>
</div>
<script>
    const form = document.getElementById('form');
    const username = document.getElementById("username");
    const password1 = document.getElementById("password1");
    const password2 = document.getElementById("password2");
    const passwordFlash = document.getElementById("passwordFlash");
    form.addEventListener('focusout', () => {
        //validate data input
        let re = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/; //8*(A-Z a-z 0-9 !@#) 
        //let re = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$/;
        if (password1.value !== password2.value) {
            passwordFlash1.innerText = "Password not match";
        } else {
            passwordFlash1.innerText = "";
        }
        if (!re.test(password1.value)) {
            passwordFlash2.innerText = "Password should contain minimum 8 characters, at least one Capital letter, one number and one special character";
        } else {
            passwordFlash2.innerText = "";
        }

        if (password1.value === password2.value && username.value && password1.value.match(re)) {
            submitBtn.removeAttribute('disabled')
        } else {
            submitBtn.setAttribute('disabled', 'disabled')
        }
    });
</script>

<%-include ("./partials/footer") -%>
<!-- updated syntax in ejs v3.0.1 -->